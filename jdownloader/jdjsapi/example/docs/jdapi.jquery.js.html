<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>jdapi.jquery.js</title>
  <link rel="stylesheet" type="text/css" charset="utf-8" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  
  <div class='section'>
    <div class='docs'><h1>jdapi.jquery.js</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <br/>

<h2>JDownloader API Bindings for jQuery</h2>
<hr />
<p><strong>namespace</strong> jQuery.jd<br/>
<strong>version</strong> 07/2011<br/>
<strong>author</strong> mhils<br/></p>
<p>The JDownloader API provides both a polling and an event streaming interface.
This wrapper is the client side reference implementation containing all features of the API.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span> <span class="nx">jdapi</span><span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span> <span class="o">=</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <h2>setOptions()</h2>
<p>Set options</p>
<p><strong>param</strong> {Object.<string, *>} options to set<br/>
<strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">setOptions</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">setOptions</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiServer</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\/$/</span><span class="p">))</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiServer</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiServer</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>getOptions()</h2>
<p>Get a clone of the current options</p>
<p><strong>return</strong> {Object.<string, *>}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">getOptions</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">getOptions</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">);</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h2>startSession()</h2>
<p>Start a session. Please note that this function is async and will
return immediately. Use the callback function for functions requiring
a session. For anonymous sessions, omit login parameters. If user and
pass are set as options, you can omit these parameters.</p>
<p><strong>param</strong> {string=} user (optional)<br/>
<strong>param</strong> {string=} pass (optional)<br/>
<strong>param</strong> {function(Object.<string, *>,?string=)=} callback<br/></p>
<p><strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">startSession</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">startSession</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">!==</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">NO_SESSION</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">REGISTERED</span><span class="p">){</span>
					<span class="nx">callback</span><span class="p">({</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">,</span>
						<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="s2">&quot;already logged in&quot;</span>
					<span class="p">});</span>
					<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">stopSession</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">startSession</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
				<span class="p">});</span> <span class="c1">// disconnect first then</span>
				<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
			<span class="p">}</span>
			
			<span class="c1">//! Shift parameters if user and pass are omitted</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">user</span><span class="p">))</span> <span class="p">{</span> 
				<span class="nx">callback</span> <span class="o">=</span> <span class="nx">user</span><span class="p">;</span>
				<span class="nx">user</span> <span class="o">=</span> <span class="nx">pass</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="o">?</span> <span class="nx">user</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">pass</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pass</span><span class="p">)</span> <span class="o">?</span> <span class="nx">pass</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">pass</span><span class="p">;</span>

			<span class="kd">var</span> <span class="nx">callbackIsFunction</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
			
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;session/handshake&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="o">?</span> <span class="p">[</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">pass</span> <span class="p">]</span>
					<span class="o">:</span> <span class="cm">/* anonymous */</span><span class="p">[</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="p">],</span> <span class="kd">function</span> <span class="nx">handshakeResponse</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span> <span class="s2">&quot;Handshake response:&quot;</span><span class="p">,</span> <span class="nx">response</span> <span class="p">);</span>
				<span class="c1">//! Check if server is returning a session id. If so, our</span>
				<span class="c1">//! handshake (either authenticated or anonymous) succeeded.</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span> <span class="o">!==</span> <span class="s2">&quot;&quot;</span>
						<span class="o">&amp;&amp;</span> <span class="nx">response</span> <span class="o">!==</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">status</span> <span class="o">=</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="o">?</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">REGISTERED</span>
							<span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">ANONYMOUS</span><span class="p">;</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">user</span><span class="p">;</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">pass</span> <span class="o">=</span> <span class="nx">pass</span><span class="p">;</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">=</span> <span class="nx">status</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">callbackIsFunction</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">callback</span><span class="p">({</span>
							<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">,</span>
							<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="nx">response</span>
						<span class="p">});</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">callbackIsFunction</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">callback</span><span class="p">({</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span>
						<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="nx">response</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">},</span> <span class="kd">function</span> <span class="nx">handshakeError</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">callbackIsFunction</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">callback</span><span class="p">({</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span>
						<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="nx">response</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">});</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h2>stopSession()</h2>
<p>Stops a session.</p>
<p><strong>param</strong> {function(Object.<string, *>,?string=)=} callback<br/>
<strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">stopSession</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">stopSession</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">NO_SESSION</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="nx">callback</span><span class="p">();</span>
				<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
			<span class="p">}</span>		
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">stopPolling</span><span class="p">();</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span> <span class="o">=</span> <span class="p">{};</span>
			<span class="c1">//! No matter whether the server invalidates the session, we do!</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">NO_SESSION</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">&quot;session/disconnect&quot;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h2>getSessionStatus()</h2>
<p>Get the current session status. See sessionStatus enum.</p>
<p><strong>return</strong> {string|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">getSessionStatus</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">getSessionStatus</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h2>startPolling()</h2>
<p>Starts polling from the server continuously</p>
<p><strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">startPolling</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">startPolling</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">isPollingContinuously</span><span class="p">())</span>
				<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">active</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">pollOnce</span><span class="p">();</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <h2>subscribe()</h2>
<p>Subscribe to events of a certain namespace. If you want to subscribe to all namespaces, use * as namespace parameter.
In this case, the callback parameter will replace the onmessage setting.</p>
<p><strong>param</strong> {string} namespace to subscribe to<br/>
<strong>param</strong> {function(Object.<string, *>, ?string=)=} callback function to be executed every time an event happens<br/>
<strong>param</strong> {function(Object.<string, *>)=} onSubscribed callback function to be executed as soon as you are subscribed.<br/>
<strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">subscribe</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">onSubscribed</span><span class="p">)</span> <span class="p">{</span>
			
			<span class="nx">namespace</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">cleanNamespace</span><span class="p">(</span><span class="nx">namespace</span><span class="p">);</span>
			
			<span class="k">if</span><span class="p">(</span><span class="nx">namespace</span> <span class="k">in</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">))</span>
					<span class="k">return</span> <span class="k">this</span><span class="p">;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Check if callback is already registered for this namespace. Skip, if so.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>				<span class="kd">var</span> <span class="nx">subscr</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">namespace</span><span class="p">];</span>
				<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">subscr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">subscr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">callback</span><span class="p">)</span>
					<span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onSubscribed</span><span class="p">))</span>
							<span class="nx">onSubscribed</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;already subscribed with that callback&quot;</span><span class="p">});</span>
						<span class="k">return</span> <span class="k">this</span><span class="p">;</span>

					<span class="p">}</span>
				<span class="p">}</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">namespace</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onSubscribed</span><span class="p">))</span>
					<span class="nx">onSubscribed</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;callback added&quot;</span><span class="p">});</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">))</span>
				<span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">callback</span><span class="p">];</span>
				<span class="p">}</span>
				
				<span class="k">if</span><span class="p">(</span><span class="nx">namespace</span> <span class="o">===</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">callback</span><span class="p">))</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>TODO: Subscribe all</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>				<span class="p">}</span>
					
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">namespace</span> <span class="o">+</span> <span class="s2">&quot;/subscribe&quot;</span><span class="p">,</span><span class="nx">onSubscribed</span><span class="p">,</span><span class="nx">onSubscribed</span><span class="p">);</span>
				
			<span class="p">}</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h2>unsubscribe()</h2>
<p>Unsubscribe from events of a certain namespace.
If you want to unsubscribe from all namespaces, use * as namespace parameter.</p>
<p><strong>param</strong> {string} namespace to unsubscribe from<br/>
<strong>param</strong> {function(Object.<string, *>)=}  onUnsubscribed callback which function to be executed after subscription has been canceled.<br/>
<strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">unsubscribe</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unsubscribe</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span> <span class="nx">onUnsubscribed</span><span class="p">){</span>
			<span class="nx">namespace</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">cleanNamespace</span><span class="p">(</span><span class="nx">namespace</span><span class="p">);</span>
			<span class="kd">var</span> <span class="nx">namespaces</span> <span class="o">=</span> <span class="p">{};</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">namespace</span> <span class="o">===</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>
				<span class="nx">namespaces</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">;</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">namespace</span> <span class="k">in</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">)</span>
				<span class="nx">namespaces</span><span class="p">[</span><span class="nx">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">namespace</span><span class="p">];</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onUnsubscribed</span><span class="p">))</span>
					<span class="nx">onUnsubscribed</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;already unsubscribed&quot;</span><span class="p">});</span>
				<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
			<span class="p">}</span>
			
			<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">namespaces</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="nx">callbacks</span><span class="p">){</span>
				
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">namespace</span> <span class="o">+</span> <span class="s2">&quot;/unsubscribe&quot;</span><span class="p">);</span>
				<span class="k">delete</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">namespace</span><span class="p">];</span>				
				
			<span class="p">});</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <h2>stopPolling()</h2>
<p>Stops polling from the server continuously</p>
<p><strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">stopPolling</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">stopPolling</span><span class="p">()</span> <span class="p">{</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">active</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span><span class="p">.</span><span class="nx">abort</span><span class="p">)</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h2>isPollingContinuously()</h2>
<p>Returns <code>true</code> if jquery is polling continuously</p>
<p><strong>return</strong> {boolean}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">isPollingContinuously</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">isPollingContinuously</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">active</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <h2>pollOnce()</h2>
<p>Poll events from the server <strong>once</strong></p>
<p><strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">pollOnce</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">pollOnce</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sessionStatus</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sessionStatus</span><span class="p">.</span><span class="nx">NO_SESSION</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">stopPolling</span><span class="p">();</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">handlePoll</span><span class="p">({</span>
					<span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span><span class="p">,</span>
					<span class="s2">&quot;message&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span>
					<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="p">{</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="s2">&quot;No active session. Did you call startSession()?&quot;</span>
					<span class="p">}</span>
				<span class="p">});</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="c1">// abort running requests</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
					<span class="nx">dataType</span> <span class="o">:</span> <span class="p">((</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">forceJSONP</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">cors</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;jsonp&quot;</span> <span class="o">:</span> <span class="s2">&quot;json&quot;</span><span class="p">),</span>
					<span class="nx">type</span> <span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
					<span class="nx">url</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">getURL</span><span class="p">(</span><span class="s1">&#39;events/listen&#39;</span><span class="p">),</span>
					<span class="nx">data</span> <span class="o">:</span> <span class="p">{</span>
						<span class="nx">token</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span>
						<span class="nx">lastEventId</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span>
					<span class="p">},</span>
					<span class="nx">async</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
					<span class="nx">cache</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
					<span class="nx">timeout</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiTimeout</span><span class="p">,</span>
					<span class="nx">success</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">handlePoll</span><span class="p">,</span>
					<span class="nx">complete</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">pollComplete</span><span class="p">,</span>
					<span class="nx">error</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">pollError</span>
				<span class="p">});</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span> <span class="s2">&quot;pollOnce&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span><span class="p">,</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span> <span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h2>getURL()</h2>
<p>Builds a query string for the API</p>
<p><strong>param</strong> {string} action to perform<br/>
<strong>param</strong> {function(Object.<string, *>,?string=)|Array.<string>=}<br/>
params (optional) parameters for this action as a JSON array (e.g.
["param1",1,1.2,"param4"]) <br/>
<strong>return</strong> {string} url<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">getURL</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">getURL</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="nx">params</span><span class="p">){</span>
			
			<span class="nx">action</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">cleanNamespace</span><span class="p">(</span><span class="nx">action</span><span class="p">);</span>
			
			<span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="nx">query</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="o">+</span><span class="nx">$</span><span class="p">.</span><span class="nx">param</span><span class="p">({</span>
					<span class="s2">&quot;token&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span>
					<span class="s2">&quot;p&quot;</span> <span class="o">:</span> <span class="nx">params</span>
				<span class="p">});</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiServer</span> <span class="o">+</span> <span class="nx">action</span> <span class="o">+</span> <span class="nx">query</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <h2>send()</h2>
<p>Perform the action on the server</p>
<p><strong>param</strong> {string} action to perform.<br/>
<strong>param</strong> {function(Object.<string, *>,?string=)|Array.<string>=}<br/>
params (optional) parameters for this action as a JSON array (e.g.
["param1",1,1.2,"param4"]) <br/>
<strong>param</strong> {function(Object.<string, *>,?string=)=} onSuccess (optional)<br/>
function to execute. Response and PID are supplied as function
parameters <br/>
<strong>param</strong> {function(Object.<string, *>)=} onError (optional) function<br/>
to execute if an error occurs. Response is supplied as function
parameter. <br/>
<strong>param</strong> {function(Object.<string, *>,?string=)=} onEvent (optional)<br/>
function to execute each time an event is streamed that refers to this
request. If this parameter is either omitted or this functions does
<em>not</em> return false, the general poll callback is invoked, too. <br/>
<strong>return</strong> {jQuery}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">send</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">send</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">onSuccess</span><span class="p">,</span> <span class="nx">onError</span><span class="p">,</span> <span class="nx">onEvent</span><span class="p">)</span> <span class="p">{</span>
			<span class="c1">//! shift callback if params are undefined</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span> <span class="p">{</span>
				<span class="nx">onEvent</span> <span class="o">=</span> <span class="nx">onError</span><span class="p">;</span>
				<span class="nx">onError</span> <span class="o">=</span> <span class="nx">onSuccess</span><span class="p">;</span>
				<span class="nx">onSuccess</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span>
				<span class="nx">params</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="c1">//! Check if callbacks are real functions</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onSuccess</span><span class="p">))</span>
				<span class="nx">onSuccess</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onEvent</span><span class="p">))</span>
				<span class="nx">onEvent</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onError</span><span class="p">))</span>
				<span class="nx">onError</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>

			<span class="c1">//! Try to interpolate if we didn&#39;t get an array for params</span>
			<span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">params</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">params</span><span class="p">))</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="p">[];</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">tmp</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
					<span class="p">});</span>
					<span class="nx">params</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span>
					<span class="nx">params</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">getURL</span><span class="p">(</span><span class="nx">action</span><span class="p">),</span> <span class="nx">params</span><span class="p">,</span> <span class="nx">onSuccess</span><span class="p">,</span> <span class="nx">onError</span><span class="p">,</span> <span class="nx">onEvent</span> <span class="p">);</span>
			<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
				<span class="nx">dataType</span> <span class="o">:</span> <span class="p">((</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">forceJSONP</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">$</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">cors</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;jsonp&quot;</span> <span class="o">:</span> <span class="s2">&quot;json&quot;</span><span class="p">),</span>
				<span class="nx">type</span> <span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
				<span class="nx">url</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">getURL</span><span class="p">(</span><span class="nx">action</span><span class="p">),</span>
				<span class="nx">data</span> <span class="o">:</span> <span class="p">{</span>
					<span class="s2">&quot;token&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span>
					<span class="s2">&quot;p&quot;</span> <span class="o">:</span> <span class="nx">params</span>
				<span class="p">},</span>
				<span class="nx">async</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
				<span class="nx">cache</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
				<span class="nx">timeout</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">apiTimeout</span><span class="p">,</span>
				<span class="nx">success</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sendSuccess</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">onSuccess</span><span class="p">,</span> <span class="nx">onError</span><span class="p">,</span> <span class="nx">onEvent</span><span class="p">);</span>
				<span class="p">},</span>
				<span class="nx">error</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">sendError</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">onError</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">});</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">;</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <h2>Settings</h2>
<p>Set by using setOptions. <strong>Don't access these properties directly.</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">_settings</span> <span class="o">:</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <h3>user</h3>
<p>Username for API auth</p>
<p><strong>type</strong> {(string|undefined)}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">user</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <h3>pass</h3>
<p>pass for API auth</p>
<p><strong>type</strong> {(string|undefined)}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">pass</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <h3>apiServer</h3>
<p>API server root url</p>
<p><strong>type</strong> {string}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">apiServer</span> <span class="o">:</span> <span class="s1">&#39;http://127.0.0.1:3128/&#39;</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <h3>onmessage</h3>
<p>Callback function to be called if an event is recieved. If the
event comes with a PID, The PIDs custom function will be executed at first.
If it returns <code>false</code>, this function won't be executed.</p>
<p><strong>type</strong> {function(Object,number=)|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">onmessage</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <h3>onerror</h3>
<p>Callback function to be called if an internal error occured.
(Disconnect, out of sync, unknown error)</p>
<p><strong>type</strong> {function(Object)|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">onerror</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <h3>debug</h3>
<p>Debug Mode. Watch your Firebug / Chrome Dev tools console.</p>
<p><strong>type</strong> {boolean}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">debug</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <h3>apiTimeout</h3>
<p>Timeout until API calls time out. Applies for both polling (once)
and sending.</p>
<p><strong>type</strong> {number}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">apiTimeout</span> <span class="o">:</span> <span class="mi">31000</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <h3>forceJSONP</h3>
<p>Use JSONP instead of JSON requests although browser supports CORS according to jQuery.</p>
<p><strong>type</strong> {boolean}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">forceJSONP</span> <span class="o">:</span> <span class="kc">false</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <h2>Enums</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">e</span> <span class="o">:</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <h3>login status</h3>
<p><strong>const</strong> {string|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">sessionStatus</span> <span class="o">:</span> <span class="p">{</span>
				<span class="nx">NO_SESSION</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
				<span class="nx">ERROR</span> <span class="o">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
				<span class="nx">ANONYMOUS</span> <span class="o">:</span> <span class="s2">&quot;anonymous&quot;</span><span class="p">,</span>
				<span class="nx">REGISTERED</span> <span class="o">:</span> <span class="s2">&quot;registered&quot;</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <h3>polling message type</h3>
<p><strong>const</strong> {string}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">messageType</span> <span class="o">:</span> <span class="p">{</span>
				<span class="nx">SYSTEM</span> <span class="o">:</span> <span class="s2">&quot;system&quot;</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <h3>polling system message type</h3>
<p><strong>const</strong> {string}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">sysMessage</span> <span class="o">:</span> <span class="p">{</span>
				<span class="nx">ERROR</span> <span class="o">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
				<span class="nx">DISCONNECT</span> <span class="o">:</span> <span class="s2">&quot;disconnect&quot;</span><span class="p">,</span>
				<span class="nx">HEARTBEAT</span> <span class="o">:</span> <span class="s2">&quot;heartbeat&quot;</span><span class="p">,</span>
				<span class="nx">OUT_OF_SYNC</span> <span class="o">:</span> <span class="s2">&quot;outofsync&quot;</span>
			<span class="p">}</span>
		<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <hr />
<h2>Internal Functions</h2>
<h2><font color="red">Stop here if you are only using this API.</font></h2>
<hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="nx">_ajax</span> <span class="o">:</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <h3>lastEventId</h3>
<p>Contains the last received message id. If connection fails due to
timeouts, messages will get fetched again.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">lastEventId</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <h3>active</h3>
<p>Status of continuous polling.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">active</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <h3>jqXHR</h3>
<p>Stores the active jqXHR object for polling. Needed for aborting
requests</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">jqXHR</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <h3>pidCallbacks</h3>
<p>Callback map storing callback functions for async requests. {pid :
callback}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">pidCallbacks</span> <span class="o">:</span> <span class="p">{},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <h3>subscriptions</h3>
<p>Callback map storing callback functions for events belonging to subscribed modules. {namespace : [callback] }
Will get executed if an event is matching the given namespace. In contrast to pidCallbacks the onmessage
function will get executed regardless of the return value
<strong>type</strong> {Object.<string, Array.<function(Object.<string, *>, ?string=)&gt;&gt;}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">subscriptions</span><span class="o">:</span> <span class="p">{},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <h3>token</h3>
<p>Current security token</p>
<p><strong>type</strong> {string|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">token</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <h3>sessionStatus</h3>
<p>Current session status</p>
<p><strong>type</strong> {string|undefined}<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">sessionStatus</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <h2>sendSuccess()</h2>
<p>Trigger/Register callbacks associated with a certain request
(fixed process id)</p>
<p><strong>param</strong> event direct return value of the request<br/>
<strong>param</strong> {function(Object.<string, *>,?string=)=} onSuccess to be<br/>
called after direct response has been recieved.
<strong>param</strong> {function(Object.<string, *>)=} onError to be called if<br/>
an error occurs
<strong>param</strong> {function(Object.<string, *>,?string=)=} onEvent to be<br/>
called if further events associated with this pid are streamed.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">sendSuccess</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">sendSuccess</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">onSuccess</span><span class="p">,</span> <span class="nx">onError</span><span class="p">,</span> <span class="nx">onEvent</span><span class="p">)</span> <span class="p">{</span>
				
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;sendSuccess:&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
				
				<span class="c1">//! Check for errors</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span>
						<span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onError</span><span class="p">))</span>
						<span class="nx">onError</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
					<span class="k">return</span><span class="p">;</span>
				<span class="p">}</span>

				<span class="c1">//! register processCallback</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onEvent</span><span class="p">))</span> <span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">pidCallbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">]</span> <span class="o">=</span> <span class="nx">onEvent</span><span class="p">;</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;Register PID...&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="c1">//! run normal callback</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onSuccess</span><span class="p">))</span>
					<span class="nx">onSuccess</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">);</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <h2>handlePoll()</h2>
<p>Handles completed poll from the server</p>
<p><strong>param</strong> {Object.<string,*>} event data received from the server<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">handlePoll</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">handlePoll</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;handlePoll: &quot;</span><span class="p">,</span><span class="nx">event</span><span class="p">,</span><span class="nx">event</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span><span class="p">);</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>accept message if lastEventId is valid. System events come out of scope</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>				<span class="k">if</span> <span class="p">((</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span> <span class="o">===</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">id</span> <span class="o">-</span> <span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">))))</span>
						<span class="o">||</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span><span class="p">))</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>System events will be handeled internally and might be
passed to the onerror function</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>					<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">switch</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">case</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">DISCONNECT</span><span class="o">:</span>
							<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">stopPolling</span><span class="p">();</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">))</span>
								<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">({</span>
									<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">DISCONNECT</span>
								<span class="p">});</span>
						<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">HEARTBEAT</span><span class="o">:</span>
						<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">OUT_OF_SYNC</span><span class="o">:</span>
							<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">stopPolling</span><span class="p">();</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">))</span>
								<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">({</span>
									<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">OUT_OF_SYNC</span>
								<span class="p">});</span>
						<span class="k">break</span><span class="p">;</span>
						<span class="k">default</span><span class="o">:</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">))</span>
								<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onerror</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="c1">// We recieved a regular event.</span>
					<span class="p">{</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s2">&quot; events in this message.&quot;</span><span class="p">);</span>

						<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">handleEvent</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
						<span class="p">});</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">else</span>
				<span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;Invalid Message id&quot;</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <h2>handleEvent()</h2>
<p>Trigger all callbacks belonging to the given event</p>
<p><strong>param</strong> {Object.<string, *>} event the event<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">handleEvent</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">handleEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span> <span class="k">in</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">pidCallbacks</span><span class="p">))</span> <span class="p">{</span>
					<span class="c1">//! If specific callback returns false,</span>
					<span class="c1">//! don&#39;t trigger general callback</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">pidCallbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">](</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span>
						<span class="k">return</span><span class="p">;</span>

				<span class="p">}</span>
				
				<span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span> <span class="k">in</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">callback</span><span class="p">){</span>
						<span class="nx">callback</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span><span class="p">,</span><span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">);</span>
					<span class="p">});</span>
				<span class="p">}</span>
				
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onmessage</span><span class="p">))</span>
					<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">onmessage</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">namespace</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">pid</span><span class="p">);</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <h2>pollComplete()</h2>
<p>Checks if continuous polling is active and polls again if
necessary</p>
<p><strong>param</strong> jqXHR see jQuery.ajax doc<br/>
<strong>param</strong> textStatus see jQuery.ajax doc<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">pollComplete</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">pollComplete</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&quot;pollComplete&quot;</span><span class="p">,</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">lastEventId</span><span class="p">);</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">jqXHR</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">active</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">active</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">debug</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">setTimeout</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">pollOnce</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">pollOnce</span><span class="p">();</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <h2>pollError()</h2>
<p>Handle ajax poll error.</p>
<p><strong>param</strong> jqXHR see jQuery.ajax doc<br/>
<strong>param</strong> textStatus see jQuery.ajax doc<br/>
<strong>param</strong> errorThrown see jQuery.ajax doc<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">pollError</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">pollError</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_ajax</span><span class="p">.</span><span class="nx">handlePoll</span><span class="p">({</span>
					<span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">messageType</span><span class="p">.</span><span class="nx">SYSTEM</span><span class="p">,</span>
					<span class="s2">&quot;message&quot;</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">sysMessage</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span>
					<span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="p">{</span>
						<span class="s2">&quot;jqXHR&quot;</span> <span class="o">:</span> <span class="nx">jqXHR</span><span class="p">,</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">textStatus</span><span class="p">,</span>
						<span class="s2">&quot;errorThrown&quot;</span> <span class="o">:</span> <span class="nx">errorThrown</span>
					<span class="p">}</span>
				<span class="p">});</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <h2>sendError()</h2>
<p>Handle ajax errors for sending.</p>
<p><strong>param</strong> jqXHR see jQuery.ajax doc<br/>
<strong>param</strong> textStatus see jQuery.ajax doc textStatus<br/>
<strong>param</strong> errorThrown see jQuery.ajax doc<br/>
<strong>param</strong> {function(Object.<string, *>,?string=)=} onError<br/>
additional callback to be executed</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">sendError</span> <span class="o">:</span> <span class="kd">function</span> <span class="nx">sendError</span><span class="p">(</span><span class="nx">jqXHR</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">,</span> <span class="nx">onError</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">onError</span><span class="p">))</span>
					<span class="nx">onError</span><span class="p">({</span>
						<span class="s2">&quot;jqXHR&quot;</span> <span class="o">:</span> <span class="nx">jqXHR</span><span class="p">,</span>
						<span class="s2">&quot;status&quot;</span> <span class="o">:</span> <span class="nx">textStatus</span><span class="p">,</span>
						<span class="s2">&quot;errorThrown&quot;</span> <span class="o">:</span> <span class="nx">errorThrown</span>
					<span class="p">});</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <h2>debug()</h2>
<p><strong>param</strong> {...*} output<br/>
Debug if debug flag is active.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">debug</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">debug</span><span class="p">(</span><span class="nx">output</span><span class="p">){</span>
				  <span class="k">if</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">jd</span><span class="p">.</span><span class="nx">_settings</span><span class="p">.</span><span class="nx">debug</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">console</span><span class="p">){</span>
					  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span> <span class="p">);</span>
				<span class="p">}</span>
			<span class="p">},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <h2>cleanNamespace()</h2>
<p>Removes leading &amp; trailing slash from a string</p>
<p><strong>param</strong> {string} namespace<br/>
<strong>return</strong> {string} Cleaned namespace<br/></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>			<span class="nx">cleanNamespace</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">cleanNamespace</span><span class="p">(</span><span class="nx">namespace</span><span class="p">){</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">namespace</span><span class="p">[</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
					<span class="nx">namespace</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">namespace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
					<span class="nx">namespace</span> <span class="o">=</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
				<span class="k">return</span> <span class="nx">namespace</span><span class="p">;</span>
			<span class="p">}</span>

		<span class="p">}</span>
	<span class="p">};</span>

<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
